<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Microcks Desktop</title>
    <style>
      html, body { height: 100%; margin: 0; font-family: system-ui, sans-serif; }
      .wrap { display: flex; height: 100%; align-items: center; justify-content: center; }
      .card { text-align: center; width: 720px; max-width: 92%; }
      .spinner { width: 48px; height: 48px; border: 4px solid #eee; border-top-color: #00a0d2; border-radius: 50%; animation: spin 1s linear infinite; margin: 16px auto; }
      @keyframes spin { to { transform: rotate(360deg); } }
      .log { margin-top: 12px; text-align: left; background: #0b0b0b; color: #d0d0d0; border-radius: 6px; padding: 8px 12px; height: 220px; overflow: auto; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; font-size: 12px; }
    </style>
  </head>
  <body>
    <div class="wrap">
      <div class="card">
        <div class="spinner"></div>
        <h2>Starting Microcks...</h2>
  <p id="status">Initializing...</p>
  <div class="log" id="log"></div>
      </div>
    </div>
    <script>
      // @ts-ignore - preload injects window.microcks
      const statusEl = document.getElementById('status');
      const logEl = document.getElementById('log');
      const disposers = [];
      disposers.push(
        window.microcks?.splash?.onStatus?.((msg) => {
          if (statusEl) statusEl.textContent = msg;
          append(`[status] ${msg}`);
        })
      );
      disposers.push(
        window.microcks?.splash?.onLog?.((line) => append(line))
      );
      function append(text) {
        if (!logEl) return;
        const div = document.createElement('div');
        div.textContent = text;
        logEl.appendChild(div);
        logEl.scrollTop = logEl.scrollHeight;
      }
      window.addEventListener('beforeunload', () => {
        for (const d of disposers) { try { d && d(); } catch {} }
      });
    </script>
  </body>
  </html>
